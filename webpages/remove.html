<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Remove Account — Connectova</title>
  <link rel="stylesheet" href="../styles/main.css" />
</head>
<body>
  <header>
    <div class="title">
      <h1>Connectova</h1>
      <p>Learn · Teach · Connect</p>
    </div>
    <nav>
      <a href="home.html">Home</a>
    </nav>
  </header>

  <main>
    <section class="section">
      <h2>Delete Account</h2>
      <p>Are you sure you want to permanently remove your account? This action cannot be undone.</p>
      <div style="margin-top:20px;">
        <!-- Redirect via window.location for simplicity -->
        <button onclick="deleteAccount()" style="background-color:#ff4d4d; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer;">
          Yes, Delete
        </button>
        <button onclick="window.location.href='home.html'" style="background-color:#ccc; color:black; padding:10px 20px; border:none; border-radius:5px; cursor:pointer; margin-left:10px;">
          No, Cancel
        </button>
      </div>
    </section>
  </main>

  <footer>© 2025 Connectova</footer>

  <script>
    function deleteAccount() {
      const email = localStorage.getItem('loggedInUser');
      if (!email) {
        window.location.href = "index.html";
        return;
      }

      // Remove user from 'users'
      let users = JSON.parse(localStorage.getItem('users') || '[]');
      users = users.filter(u => u.email !== email);
      localStorage.setItem('users', JSON.stringify(users));

      // Remove login info
      localStorage.removeItem('loggedInUser');
      localStorage.removeItem('userRole');

      // Remove related data
      const teacherQuizzes = JSON.parse(localStorage.getItem('teacherQuizzes') || '[]')
        .filter(q => q.uploaderEmail !== email);
      localStorage.setItem('teacherQuizzes', JSON.stringify(teacherQuizzes));

      const studentScores = JSON.parse(localStorage.getItem('studentScores') || '[]')
        .filter(s => s.email !== email);
      localStorage.setItem('studentScores', JSON.stringify(studentScores));

      const sharedReports = JSON.parse(localStorage.getItem('sharedReports') || '[]')
        .filter(r => r.sharedBy !== email);
      localStorage.setItem('sharedReports', JSON.stringify(sharedReports));

      // Redirect after deletion
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
